<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë£°ë › ê²Œì„</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            text-align: center;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 500px;
            margin: 0 auto;
            box-sizing: border-box;
        }

        .loading {
            min-height: 400px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .loading-spinner {
            font-size: 18px;
            color: #666;
            margin-top: 20px;
            animation: pulse 1.5s ease-in-out infinite;
        }

        @keyframes pulse {

            0%,
            100% {
                opacity: 1;
            }

            50% {
                opacity: 0.5;
            }
        }

        .input-section {
            margin-bottom: 20px;
        }

        .input-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 10px;
            max-width: 400px;
            margin: 0 auto;
        }

        .player-input {
            padding: 12px 8px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 16px;
            width: 100%;
            box-sizing: border-box;
            min-height: 44px;
        }

        .player-input:focus {
            outline: none;
            border-color: #2196f3;
            box-shadow: 0 0 0 2px rgba(33, 150, 243, 0.2);
        }

        .canvas-container {
            position: relative;
            display: inline-block;
            margin: 20px 0;
        }

        canvas {
            cursor: pointer;
            border-radius: 50%;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            max-width: 100%;
            height: auto;
        }

        button {
            padding: 12px 20px;
            margin: 8px 4px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.2s ease;
            min-height: 44px;
            min-width: 120px;
        }

        .update-button {
            background-color: #2196f3;
            color: white;
        }

        .update-button:hover {
            background-color: #1976d2;
            transform: translateY(-1px);
        }

        .spin-button {
            background-color: #4caf50;
            color: white;
            font-size: 18px;
            padding: 15px 30px;
        }

        .spin-button:hover:not(:disabled) {
            background-color: #45a049;
            transform: translateY(-1px);
        }

        .spin-button:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
            transform: none;
        }

        .rigged-button {
            width: 50px;
            height: 50px;
            opacity: 0;
            position: absolute;
            font-size: 14px;
            padding: 8px 12px;
            min-width: auto;
            min-height: auto;
            border-radius: 50%;
        }

        .result {
            margin-top: 20px;
            font-size: clamp(18px, 5vw, 24px);
            font-weight: bold;
            color: #333;
            animation: fadeIn 0.5s ease-in;
            padding: 15px;
            background: linear-gradient(135deg, #ffeaa7, #fab1a0);
            border-radius: 10px;
            border: 2px solid #e17055;
            display: none;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        h1 {
            color: #333;
            margin-bottom: 20px;
            font-size: clamp(24px, 6vw, 32px);
        }

        h3 {
            color: #666;
            margin-bottom: 15px;
            font-size: clamp(16px, 4vw, 20px);
        }

        /* ë°˜ì‘í˜• ë¯¸ë””ì–´ ì¿¼ë¦¬ë“¤ */
        @media (max-width: 480px) {
            .container {
                padding: 15px;
                margin: 10px;
                border-radius: 8px;
            }

            .input-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 8px;
            }

            .player-input {
                font-size: 16px;
            }

            button {
                margin: 6px 2px;
                padding: 12px 16px;
            }

            .spin-button {
                width: 100%;
                max-width: 280px;
            }

            .rigged-button {
                right: 2px;
                font-size: 12px;
                padding: 6px 10px;
            }

            .result {
                margin: 15px -5px 0;
                padding: 12px;
            }
        }

        @media (min-width: 481px) and (max-width: 768px) {
            .container {
                padding: 25px;
            }

            .input-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-height: 600px) and (orientation: landscape) {
            .container {
                padding: 10px;
            }

            h1 {
                margin-bottom: 10px;
            }

            .input-section {
                margin-bottom: 15px;
            }

            .canvas-container {
                margin: 15px 0;
            }
        }

        .button-container {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 12px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        @media (max-width: 480px) {
            .button-container {
                flex-direction: column;
                gap: 8px;
            }

            .spin-button,
            .rigged-button {
                width: 100%;
                max-width: 280px;
            }
        }

        /* ë‹¤í¬ëª¨ë“œ ì§€ì› */
        @media (prefers-color-scheme: dark) {
            body {
                background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            }

            .container {
                background: #2c3e50;
                color: white;
            }

            h1,
            h3 {
                color: #ecf0f1;
            }

            .player-input {
                background: #34495e;
                border-color: #4a5f7a;
                color: white;
            }

            .player-input:focus {
                border-color: #3498db;
            }
        }
    </style>
</head>

<body>
    <div class="container" id="app">
        <h1>ğŸ¯ ë£°ë › ê²Œì„</h1>

        <div class="input-section">
            <h3>ì°¸ê°€ì ì´ë¦„ ì…ë ¥</h3>
            <div class="input-grid" id="inputGrid">
                <!-- JavaScriptë¡œ ë™ì  ìƒì„± -->
            </div>
        </div>

        <button class="update-button" onclick="updatePlayers()" type="button">
            ğŸ“ ì°¸ê°€ì ì—…ë°ì´íŠ¸
        </button>

        <div class="canvas-container">
            <canvas id="rouletteCanvas"></canvas>

        </div>

        <div class="button-container">
            <button class="spin-button" id="spinButton" onclick="handleNormalSpin()" type="button">
                ğŸ² ë£°ë › ëŒë¦¬ê¸°
            </button>
            <button class="rigged-button" onclick="handleRiggedSpin()" type="button" title="íŠ¹ë³„ ëª¨ë“œ">
                â­ íŠ¹ë³„
            </button>
        </div>


        <div class="result" id="result" role="alert" aria-live="polite"></div>
    </div>

    <script>
        /**
         * ì „ì—­ ë³€ìˆ˜ë“¤ (TypeScript íƒ€ì… ì •ì˜ë¥¼ JavaScript ì£¼ì„ìœ¼ë¡œ ë³€í™˜)
         */

        // HTMLCanvasElement
        let canvas = null;
        // CanvasRenderingContext2D | null
        let ctx = null;
        // Player[]
        let players = [];
        // number
        let currentRotation = 0;
        // boolean
        let isSpinning = false;
        // string
        let result = '';
        // boolean
        let mounted = false;

        // RouletteConfig
        let config = {
            canvasSize: 300,
            centerX: 150,
            centerY: 150,
            radius: 120
        };

        // string[]
        let playerInputs = ['í™ê¸¸ë™', 'ê¹€ì² ìˆ˜', 'ì´ì˜í¬', 'ë°•ë¯¼ìˆ˜'];

        // ìƒìˆ˜ë“¤
        const MAX_PLAYERS = 8;
        const MIN_PLAYERS = 1;
        const DEFAULT_ANIMATION_DURATION = 5000;
        const RIGGED_NAMES = ['ì§„í˜', 'ë™í•˜'];

        // ìƒ‰ìƒ íŒ”ë ˆíŠ¸
        const COLOR_PALETTE = [
            '#FF6B6B',
            '#4ECDC4',
            '#45B7D1',
            '#FFA07A',
            '#98D8C8',
            '#F7DC6F',
            '#BB8FCE',
            '#85C1E2'
        ];

        /**
         * ë¸Œë¼ìš°ì € í™˜ê²½ì—ì„œë§Œ window ê°ì²´ ì‚¬ìš©
         * @returns {number}
         */
        function getWindowWidth() {
            if (!mounted) return 400; // ê¸°ë³¸ê°’ ë°˜í™˜
            return window.innerWidth;
        }

        /**
         * í™”ë©´ í¬ê¸° ê°ì§€ í•¨ìˆ˜
         * @returns {'mobile' | 'tablet' | 'desktop'}
         */
        function getScreenSize() {
            const screenWidth = getWindowWidth();

            if (screenWidth < 480) return 'mobile';
            if (screenWidth < 768) return 'tablet';
            return 'desktop';
        }

        /**
         * í™”ë©´ í¬ê¸°ì— ë”°ë¥¸ ìº”ë²„ìŠ¤ í¬ê¸° ì¡°ì •
         */
        function updateCanvasSize() {
            if (!mounted) return;

            const screenSize = getScreenSize();
            const screenWidth = getWindowWidth();

            switch (screenSize) {
                case 'mobile':
                    config.canvasSize = Math.min(screenWidth - 40, 280);
                    break;
                case 'tablet':
                    config.canvasSize = 350;
                    break;
                case 'desktop':
                    config.canvasSize = 400;
                    break;
            }

            config.centerX = config.canvasSize / 2;
            config.centerY = config.canvasSize / 2;
            config.radius = config.canvasSize * 0.35;

            if (canvas && ctx) {
                canvas.width = config.canvasSize;
                canvas.height = config.canvasSize;
                drawWheel();
            }
        }

        /**
         * ì°¸ê°€ì ë°°ì—´ ìƒì„± í•¨ìˆ˜
         * @param {string[]} inputs 
         * @returns {Player[]}
         */
        function createPlayers(inputs) {
            const validPlayers = [];

            inputs.forEach((name, index) => {
                const trimmedName = name.trim();
                if (trimmedName && index < MAX_PLAYERS) {
                    const player = {
                        id: `player-${index}-${Date.now()}`,
                        name: trimmedName,
                        color: COLOR_PALETTE[index] || COLOR_PALETTE[0],
                        index: validPlayers.length
                    };
                    validPlayers.push(player);
                }
            });

            return validPlayers;
        }

        /**
         * ì…ë ¥ í•„ë“œ ìƒì„±
         */
        function createInputFields() {
            const inputGrid = document.getElementById('inputGrid');
            inputGrid.innerHTML = '';

            for (let i = 0; i < MAX_PLAYERS; i++) {
                const input = document.createElement('input');
                input.type = 'text';
                input.className = 'player-input';
                input.placeholder = `ì°¸ê°€ì ${i + 1}`;
                input.maxLength = 10;
                input.value = playerInputs[i] || '';

                // ì…ë ¥ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
                input.addEventListener('input', (e) => {
                    playerInputs[i] = e.target.value;
                });

                inputGrid.appendChild(input);
            }
        }

        /**
         * ì°¸ê°€ì ì •ë³´ ì—…ë°ì´íŠ¸ í•¨ìˆ˜
         */
        function updatePlayers() {
            // í˜„ì¬ ì…ë ¥ í•„ë“œ ê°’ë“¤ì„ playerInputs ë°°ì—´ì— ë°˜ì˜
            const inputs = document.querySelectorAll('.player-input');
            inputs.forEach((input, index) => {
                playerInputs[index] = input.value;
            });

            players = createPlayers(playerInputs);

            if (players.length < MIN_PLAYERS) {
                alert(`ìµœì†Œ ${MIN_PLAYERS}ëª…ì˜ ì°¸ê°€ìë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.`);
                return;
            }

            currentRotation = 0;
            hideResult();
            if (mounted) {
                drawWheel();
            }

            console.log(`ì°¸ê°€ì ${players.length}ëª… ì—…ë°ì´íŠ¸ ì™„ë£Œ:`, players.map(p => p.name));
        }

        /**
         * í…ìŠ¤íŠ¸ ê¸¸ì´ì— ë”°ë¥¸ í‘œì‹œ í…ìŠ¤íŠ¸ ìƒì„±
         * @param {string} text 
         * @param {number} maxLength 
         * @returns {string}
         */
        function getDisplayText(text, maxLength = 6) {
            if (text.length <= maxLength) return text;
            return text.substring(0, maxLength - 1) + 'â€¦';
        }

        /**
         * ë°˜ì‘í˜• í°íŠ¸ í¬ê¸° ê³„ì‚°
         * @returns {number}
         */
        function calculateFontSize() {
            return Math.max(12, config.canvasSize * 0.04);
        }

        /**
         * ë£°ë › íœ  ê·¸ë¦¬ê¸° í•¨ìˆ˜
         */
        function drawWheel() {
            if (!ctx || players.length === 0 || !mounted) return;

            ctx.clearRect(0, 0, config.canvasSize, config.canvasSize);
            const anglePerSection = (2 * Math.PI) / players.length;

            // ê° ì°¸ê°€ì ì„¹ì…˜ ê·¸ë¦¬ê¸°
            players.forEach((player) => {
                const startAngle = player.index * anglePerSection + currentRotation;
                const endAngle = (player.index + 1) * anglePerSection + currentRotation;

                // ì„¹ì…˜ ë°°ê²½ ê·¸ë¦¬ê¸°
                ctx.beginPath();
                ctx.moveTo(config.centerX, config.centerY);
                ctx.arc(config.centerX, config.centerY, config.radius, startAngle, endAngle);
                ctx.closePath();
                ctx.fillStyle = player.color;
                ctx.fill();
                ctx.strokeStyle = '#333';
                ctx.lineWidth = 2;
                ctx.stroke();

                // ì°¸ê°€ì ì´ë¦„ í…ìŠ¤íŠ¸ ê·¸ë¦¬ê¸°
                ctx.save();
                ctx.translate(config.centerX, config.centerY);
                ctx.rotate(startAngle + anglePerSection / 2);
                ctx.textAlign = 'center';
                ctx.fillStyle = '#fff';
                ctx.font = `bold ${calculateFontSize()}px Arial`;
                ctx.shadowColor = 'rgba(0,0,0,0.5)';
                ctx.shadowBlur = 2;
                ctx.shadowOffsetX = 1;
                ctx.shadowOffsetY = 1;

                const displayText = getDisplayText(player.name);
                ctx.fillText(displayText, config.radius * 0.6, 5);
                ctx.restore();
            });

            drawCenterElements();
        }

        /**
         * ì¤‘ì•™ ì›ê³¼ í™”ì‚´í‘œ ê·¸ë¦¬ê¸°
         */
        function drawCenterElements() {
            if (!ctx || !mounted) return;

            // ì¤‘ì•™ ì› ê·¸ë¦¬ê¸°
            const centerCircleRadius = config.canvasSize * 0.05;
            ctx.beginPath();
            ctx.arc(config.centerX, config.centerY, centerCircleRadius, 0, 2 * Math.PI);
            ctx.fillStyle = '#333';
            ctx.fill();
            ctx.strokeStyle = '#fff';
            ctx.lineWidth = 2;
            ctx.stroke();

            // í™”ì‚´í‘œ í¬ì¸í„° ê·¸ë¦¬ê¸°
            const arrowSize = config.canvasSize * 0.04;
            const arrowY = config.canvasSize * 0.08;

            ctx.beginPath();
            ctx.moveTo(config.centerX - arrowSize, arrowY);
            ctx.lineTo(config.centerX + arrowSize, arrowY);
            ctx.lineTo(config.centerX, arrowY + arrowSize * 1.5);
            ctx.closePath();
            ctx.fillStyle = '#FF0000';
            ctx.fill();
            ctx.strokeStyle = '#333';
            ctx.lineWidth = 2;
            ctx.stroke();
        }

        /**
         * í˜„ì¬ ë‹¹ì²¨ì íŒë³„ í•¨ìˆ˜
         * @returns {number | null}
         */
        function getCurrentWinner() {
            if (players.length === 0) return null;

            const anglePerSection = (2 * Math.PI) / players.length;
            const pointerAngle = 1.5 * Math.PI; // 12ì‹œ ë°©í–¥

            let normalizedRotation = currentRotation % (2 * Math.PI);
            let effectiveAngle = pointerAngle - normalizedRotation;

            if (effectiveAngle < 0) {
                effectiveAngle += 2 * Math.PI;
            }

            const winnerIndex = Math.floor(effectiveAngle / anglePerSection);
            return winnerIndex >= 0 && winnerIndex < players.length ? winnerIndex : null;
        }

        /**
         * ì• ë‹ˆë©”ì´ì…˜ ì„¤ì • ìƒì„±
         * @param {number} targetIndex 
         * @returns {AnimationConfig}
         */
        function createAnimationConfig(targetIndex) {
            const anglePerSection = (2 * Math.PI) / players.length;
            const targetSliceCenter = targetIndex * anglePerSection + anglePerSection / 2;
            const baseTargetRotation = 1.5 * Math.PI - targetSliceCenter;
            const randomOffset = (Math.random() - 0.5) * anglePerSection * 0.8;
            const additionalRotations = 5 + Math.floor(Math.random() * 5);
            const duration = DEFAULT_ANIMATION_DURATION + Math.random() * 1000;

            return {
                duration,
                additionalRotations,
                randomOffset: baseTargetRotation + randomOffset
            };
        }

        /**
         * ë£°ë › ìŠ¤í•€ ì• ë‹ˆë©”ì´ì…˜ í•¨ìˆ˜
         * @param {number | null} targetIndex 
         */
        function spinWheel(targetIndex = null) {
            if (!mounted || isSpinning || players.length === 0) return;

            isSpinning = true;
            hideResult();
            updateSpinButton(true);

            // ëª©í‘œ ì¸ë±ìŠ¤ ê²°ì •
            const finalTargetIndex = targetIndex !== null ? targetIndex : Math.floor(Math.random() * players.length);
            const animConfig = createAnimationConfig(finalTargetIndex);

            const startRotation = currentRotation;
            const rotationsDone = Math.floor(startRotation / (2 * Math.PI));
            const finalDestination = (rotationsDone + animConfig.additionalRotations) * (2 * Math.PI) + animConfig.randomOffset;

            const totalRotationAmount = finalDestination - startRotation;
            const startTime = Date.now();

            console.log(`ğŸ¯ ëª©í‘œ: ${players[finalTargetIndex]?.name} (index: ${finalTargetIndex})`);

            /**
             * ì• ë‹ˆë©”ì´ì…˜ í”„ë ˆì„ í•¨ìˆ˜
             */
            function animate() {
                if (!mounted) return;

                const now = Date.now();
                const elapsed = now - startTime;
                const progress = Math.min(elapsed / animConfig.duration, 1);

                // easeOutQuart ê°ì† íš¨ê³¼
                const easeProgress = 1 - Math.pow(1 - progress, 4);

                currentRotation = startRotation + totalRotationAmount * easeProgress;
                drawWheel();

                if (progress < 1) {
                    requestAnimationFrame(animate);
                } else {
                    finishSpin();
                }
            }

            animate();
        }

        /**
         * ìŠ¤í•€ ì™„ë£Œ ì²˜ë¦¬
         */
        function finishSpin() {
            isSpinning = false;
            updateSpinButton(false);

            const winnerIndex = getCurrentWinner();

            if (winnerIndex !== null && players[winnerIndex]) {
                const winner = players[winnerIndex];
                showResult(winner);
                console.log(`ğŸ† ë‹¹ì²¨ì: ${winner.name}`);
            } else {
                showResult({ name: 'Error', color: '#FF0000' });
            }
        }

        /**
         * ë°°ì—´ì—ì„œ ëœë¤ ìš”ì†Œ ì„ íƒ
         * @param {Array} array 
         * @returns {*}
         */
        function getRandomElement(array) {
            const randomIndex = Math.floor(Math.random() * array.length);
            return array[randomIndex];
        }

        /**
         * ì¼ë°˜ ìŠ¤í•€ í•¨ìˆ˜
         */
        function normalSpin() {
            if (players.length === 0) {
                alert('ë¨¼ì € ì°¸ê°€ìë¥¼ ì…ë ¥í•˜ê³  ì—…ë°ì´íŠ¸í•˜ì„¸ìš”.');
                return;
            }
            spinWheel();
        }

        /**
         * ì¡°ì‘ëœ ìŠ¤í•€ í•¨ìˆ˜ - ì°¸ê°€ìê°€ ì—†ì–´ë„ ì‘ë™í•˜ë„ë¡ ê°œì„ 
         */
        function riggedSpin() {
            if (players.length === 0) {
                alert('ë¨¼ì € ì°¸ê°€ìë¥¼ ì…ë ¥í•˜ê³  ì—…ë°ì´íŠ¸í•˜ì„¸ìš”.');
                return;
            }

            // ì¡°ì‘ ëŒ€ìƒ ì¤‘ ì‹¤ì œ ì°¸ê°€ìë§Œ í•„í„°ë§
            const validNames = RIGGED_NAMES.filter((name) =>
                players.some((player) => player.name === name)
            );

            if (validNames.length === 0) {
                // ì¡°ì‘ ëŒ€ìƒì´ ì—†ì„ ë•Œë„ ì¼ë°˜ ìŠ¤í•€ìœ¼ë¡œ ì‘ë™
                console.log('ğŸ² ì¡°ì‘ ëŒ€ìƒì´ ì—†ì–´ì„œ ì¼ë°˜ ëª¨ë“œë¡œ ì‹¤í–‰í•©ë‹ˆë‹¤.');
                spinWheel(); // ì¼ë°˜ ëœë¤ ìŠ¤í•€ ì‹¤í–‰
                return;
            }

            // ìœ íš¨í•œ ì¡°ì‘ ëŒ€ìƒ ì¤‘ì—ì„œ ëœë¤ ì„ íƒ
            const selectedName = getRandomElement(validNames);
            const targetPlayer = players.find((player) => player.name === selectedName);

            if (targetPlayer) {
                console.log(`ğŸ² ì¡°ì‘ ëª¨ë“œ: ${targetPlayer.name} ì„ íƒ`);
                spinWheel(targetPlayer.index);
            }
        }


        /**
         * ìŠ¤í•€ í•¸ë“¤ëŸ¬ë“¤
         */
        function handleNormalSpin() {
            if (!mounted) return;
            normalSpin();
        }

        function handleRiggedSpin() {
            if (!mounted) return;
            riggedSpin();
        }

        /**
         * ê²°ê³¼ í‘œì‹œ í•¨ìˆ˜
         * @param {Player} winner 
         */
        function showResult(winner) {
            const resultDiv = document.getElementById('result');
            resultDiv.textContent = `ğŸ‰ ë‹¹ì²¨ì: ${winner.name} ğŸ‰`;
            resultDiv.style.display = 'block';
        }

        /**
         * ê²°ê³¼ ìˆ¨ê¸°ê¸°
         */
        function hideResult() {
            const resultDiv = document.getElementById('result');
            resultDiv.style.display = 'none';
        }

        /**
         * ìŠ¤í•€ ë²„íŠ¼ ìƒíƒœ ì—…ë°ì´íŠ¸
         * @param {boolean} spinning 
         */
        function updateSpinButton(spinning) {
            const spinButton = document.getElementById('spinButton');
            if (spinning) {
                spinButton.textContent = 'ğŸŒ€ ëŒë¦¬ëŠ” ì¤‘...';
                spinButton.disabled = true;
            } else {
                spinButton.textContent = 'ğŸ² ë£°ë › ëŒë¦¬ê¸°';
                spinButton.disabled = false;
            }
        }

        /**
         * ì´ˆê¸°í™” í•¨ìˆ˜ (onMount ëŒ€ì²´)
         */
        function init() {
            canvas = document.getElementById('rouletteCanvas');
            if (!canvas) {
                console.error('Canvas ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }

            const context = canvas.getContext('2d');
            if (!context) {
                console.error('Canvas contextë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }

            ctx = context;
            mounted = true;

            // ì…ë ¥ í•„ë“œ ìƒì„±
            createInputFields();

            // ì´ˆê¸° ì„¤ì •
            updateCanvasSize();
            updatePlayers();

            // ë¦¬ì‚¬ì´ì¦ˆ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡
            window.addEventListener('resize', updateCanvasSize);

            console.log('ğŸ¯ ë£°ë › ê²Œì„ì´ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤!');
        }

        /**
         * ì •ë¦¬ í•¨ìˆ˜ (onDestroy ëŒ€ì²´)
         */
        function cleanup() {
            if (mounted) {
                window.removeEventListener('resize', updateCanvasSize);
            }
            mounted = false;
        }

        // í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤ ì´ë²¤íŠ¸
        document.addEventListener('keydown', (e) => {
            if (!mounted || isSpinning) return;

            if (e.key === 'Enter' || e.key === ' ') {
                e.preventDefault();
                normalSpin();
            }
        });

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
        window.addEventListener('load', init);

        // í˜ì´ì§€ ì–¸ë¡œë“œ ì‹œ ì •ë¦¬
        window.addEventListener('beforeunload', cleanup);

        console.log('ğŸ¯ ë£°ë › ê²Œì„ ìŠ¤í¬ë¦½íŠ¸ ë¡œë“œ ì™„ë£Œ! Enter ë˜ëŠ” Spaceë¡œ ìŠ¤í•€ ê°€ëŠ¥í•©ë‹ˆë‹¤.');
    </script>
</body>

</html>